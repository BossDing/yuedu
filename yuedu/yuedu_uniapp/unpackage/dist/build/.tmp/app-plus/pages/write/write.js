(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/write/write"],{aa5c:function(t,e,n){"use strict";n.r(e);var i=n("ed01"),a=n("e7ca");for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);var s=n("2877"),c=Object(s["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},af08:function(t,e,n){"use strict";(function(t){n("075a"),n("921b");i(n("66fd"));var e=i(n("aa5c"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},b3b6:function(t,e,n){"use strict";(function(t){var n,i;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{title:"",artList:[],inputContent:"",needUploadImg:[],uploadIndex:0,caties:[{cate_id:0,cate_pid:0,cate_name:"请选择",cate_order:1}],currentCateIndex:0,catiesFromApi:[],sedCateIndex:0}},onLoad:function(){n=this,t.request({url:this.ctx+"categories/getAll",method:"GET",data:{},success:function(t){t=t.data;for(var e=0;e<t.length;e++)n.caties.push(t[e])},fail:function(){},complete:function(){}})},onTabItemTap:function(){i=this.checkLogin("../write/write",2)},methods:{cateChange:function(t){this.currentCateIndex=t.detail.value,this.sedCateIndex=this.caties[this.currentCateIndex].cate_id},addImg:function(){t.chooseImage({count:1,sizeType:["compressed"],success:function(t){n.artList.push({type:"image",content:t.tempFilePaths[0]})}})},removeImg:function(e){var i=e.currentTarget.dataset.index;t.showModal({content:"确定要删除吗",title:"提示",success:function(t){t.confirm&&n.artList.splice(i,1)}})},submit:function(e){var n=e.detail.value.artText;n.length<1?t.showToast({title:"请输入内容",icon:"none"}):(this.artList.push({type:"text",content:n}),this.inputContent="")},deleteText:function(e){var i=e.currentTarget.dataset.index;t.showModal({content:"确定要删除吗",title:"提示",success:function(t){t.confirm&&n.artList.splice(i,1)}})},submitNow:function(){if(this.title.length<2)t.showToast({title:"请输入标题",icon:"none"});else if(this.artList.length<1)t.showToast({title:"请填写文章内容",icon:"none"});else if(this.sedCateIndex<1)t.showToast({title:"请选择分类",icon:"none"});else{this.needUploadImg=[];for(var e=0;e<this.artList.length;e++)"image"==this.artList[e].type&&this.needUploadImg.push({tmpurl:this.artList[e].content,indexID:e});this.uploadImg()}},uploadImg:function(){if(this.needUploadImg.length<1||this.uploadIndex>=this.needUploadImg.length)return t.showLoading({title:"正在提交"}),void t.request({url:this.ctx+"articles/addArticle",method:"POST",data:{art_title:n.title,art_content:JSON.stringify(n.artList),art_uid:i[0],art_cate:n.sedCateIndex},success:function(e){"ok"==e.data.status?(t.showToast({title:"提交成功",icon:"none"}),n.artList=[],n.currentCateIndex=0,n.sedCateIndex=0,n.needUploadImg=[],n.title="",t.hideLoading(),setTimeout(function(){t.switchTab({url:"../write/write"})},1e3)):t.showToast({title:e.data.data,icon:"none"})},fail:function(t){},complete:function(){}});t.showLoading({title:"上传图片"});t.uploadFile({url:n.ctx+"fileUpload",filePath:n.needUploadImg[n.uploadIndex].tmpurl,name:"file",success:function(t){t=t.data;var e=n.needUploadImg[n.uploadIndex].indexID;n.artList[e].content=n.ctx+t,n.uploadIndex++,setTimeout(function(){n.uploadImg()},1e3)},fail:function(){t.showToast({title:"上传图片失败,请重试!",icon:"none"})}})}}};e.default=a}).call(this,n("6e42")["default"])},e7ca:function(t,e,n){"use strict";n.r(e);var i=n("b3b6"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,function(){return i[t]})}(o);e["default"]=a.a},ed01:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})}},[["af08","common/runtime","common/vendor"]]]);